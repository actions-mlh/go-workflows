# Github Workflow Parser

A Go command line tool for linting and validating GitHub Actions.

## Usage

Clone this repository and run

``
go generate ./...
``

to create a Go type file in `gen/`.  Uses `schema/json/github-workflow.json` by default (obtained from [here](https://json.schemastore.org/github-workflow.json)); edit the `//go:generate` directive in `main.go` to use a different file.

When the types are generated,

``
go run ./parse/cmd/parser/main.go yourfilehere.yaml
``

will invoke `main.go` and attempt to lint your YAML workflow.  The actual logic for linting lives in `parse/`.  If any problems are detected, they will be emitted to stdout; if not, then the output will be empty.

## Details

This tool will use a fork of [this module](https://github.com/a-h/generate) to convert a JSON specification of GitHub actions into a Go file with a long list of types.  Those types will then be used by the code in `parse/` to do the actual linting.  The code in `parse/` will leverage [this package](https://pkg.go.dev/gopkg.in/yaml.v3) to read the YAML file, and will attempt to cast the YAML it reads into the types generated by the previous step.  Any mismatches or detected errors will be collected into a sink and dumped to stdout.

As mentioned, `schema/` contains the code to generate Go types, and `parse/` contains the parsing and linting code.  `gen/` contains the generated code, and `gen_mock/` contains handwritten code that looks similar to the code in `gen/` for testing purposes.  `yaml/` contains sample YAML files, also for testing.

## Contact

This project is maintained by @jjayeon and @hankc97, under the guidance of @aybabtme and @joshmgross.  Please contact any of us for more information.
